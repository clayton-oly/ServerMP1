@page "/Detail"
@using ServerMP1.DTOs

<h3>Detail</h3>

@*Playground*@
<div class="row">
    <div class="col-12 p-4 bg-light">
        <h1>Products Playground</h1>
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>Id</th>
                    <th>Name</th>
                    <th>Price</th>
                    <th>Stock</th>
                    <th>Active</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var product in listProductsDTOs)
                {
                    <tr>
                        <td>@product.Id</td>
                        <td>
                            Name:
                            <input type="text" @bind-value = "@product.Name" @bind-value:event="oninput"/>
                        </td>
                        <td>
                            Price:
                            <input type="number" @bind-value="@product.Price" @bind-value:event="oninput" />
                        </td>
                        <td>
                            Stock:
                            <input type="number" @bind-value="@product.Stock" @bind-value:event="oninput" />
                        </td>
                        <td>
                            Category:
                            <select @bind="product.CategoryName">
                                @foreach (var cat in Categories)
                                {
                                    <option value="@cat">
                                        @cat
                                    </option>
                                })
                            </select>
                        </td>
                        <td>
                            IsActive:
                            <input type="checkbox" @bind="product.IsActive" />
                        </td>
                        <td>
                            <button class="btn btn-primary" @onclick="() => ShowDetails(product)">Details</button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

@*Summary*@
<div class="row">
    <div class="col-12 p-4 bg-light">
        <h1>Products Sumarry</h1>
    </div>
    <ul>
        <li>

        </li>
    </ul>
</div>

@code {
    private List<ProductDTO> listProductsDTOs = new();

    private ProductDTO? selectedProduct;

    //Lista para alimentar o select
    private List<string> Categories = new()
    {
        "Lanche",
        "Bebida",
        "Sobremesa"
    };

    //Exibir detalhes
    private void ShowDetails(ProductDTO product) => selectedProduct = product;

    private void ProductsList()
    {
        //Populando a lista de produtos
        listProductsDTOs = new List<ProductDTO>
        {
            new ProductDTO { Id = 1, Name = "Hambúrguer", Description = "Lanche com Cheddar", UrlImagem="" ,Price = 15.00m, IsActive = true, CategoryName = "Lanche" },
            new ProductDTO { Id = 2, Name = "Refrigerante",Description = "Coca-Cola", UrlImagem="", Price = 5.00m, IsActive = true, CategoryName = "Bebida" },
            new ProductDTO { Id = 3, Name = "Sorvete", Description = "De murango tango", UrlImagem="", Price = 7.00m, IsActive = true, CategoryName = "Sobremesa" }
        };
    }

    protected override void OnInitialized()
    {
        ProductsList();
    }
}
